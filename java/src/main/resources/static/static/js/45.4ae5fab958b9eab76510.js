webpackJsonp([45],{DzQl:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("aA9S"),a=r.n(n),s=r("lC5x"),i=r.n(s),o=r("J0Oq"),d=r.n(o),l=r("0Njg"),c=r("R2SV"),u={props:{onOk:{type:Function,default:function(){}}},data:function(){return{getCusInterfacesItemListApi:l.E,nodeId:null,node:{sleep:0,interfaceId:null,interfaceName:null,history:!1,hash:null,method:null,url:null,parameters:null,preParams:null,headers:[],javascript:null,returns:null,java:null},generatedReturns:null,interfacesVersionedSimpleListApi:l.V,interfacesSimpleListApi:l.T,functionListApi:l.A,customInterfacesId:null}},methods:{onSelectCusInterfacesItem:function(e){var t=e[0];t&&(this.node.parameters=t.cusParameters?JSON.parse(t.cusParameters):[],this.node.javascript=t.javascript?JSON.parse(t.javascript):null,this.node.preParams=t.preParams?JSON.parse(t.preParams):null,t.cusHeaders&&(this.node.headers=JSON.parse(t.cusHeaders)))},onSelectInterface:function(e){var t=this;return d()(i.a.mark(function r(){var n;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e[0]||{},t.node.interfaceId=n.id,t.node.interfaceName=n.name,t.node.hash=null,r.t0=t,r.next=7,t.getConfiguredParameters(n.id,n);case 7:r.t1=r.sent,r.t0.setInterfaces.call(r.t0,r.t1);case 9:case"end":return r.stop()}},r,t)}))()},loadCusInterfacesItem:function(e){var t=this;return d()(i.a.mark(function r(){var n,a,s;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(t.customInterfacesId=null,e){r.next=3;break}return r.abrupt("return");case 3:return r.next=5,Object(l.D)(e);case 5:if(!(n=r.sent)){r.next=12;break}return t.customInterfacesId=n.id,r.next=10,Object(l.E)({customInterfacesId:n.id});case 10:(a=r.sent).length>0&&(s=a[0],t.node.parameters=s.cusParameters?JSON.parse(s.cusParameters):[],t.node.javascript=s.javascript?JSON.parse(s.javascript):null,t.node.preParams=s.preParams?JSON.parse(s.preParams):null,s.cusHeaders&&(t.node.headers=JSON.parse(s.cusHeaders)));case 12:case"end":return r.stop()}},r,t)}))()},getConfiguredParameters:function(e,t){var r=this;return d()(i.a.mark(function n(){return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return",{});case 2:return t.parameters=Object(c.c)(t.parameters),r.abrupt("return",t);case 4:case"end":return r.stop()}},n,r)}))()},onSelectHistoryInterface:function(e){var t=this;return d()(i.a.mark(function r(){var n;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n=e[0]||{},t.node.hash=n.hash,r.t0=t,r.next=5,t.getConfiguredParameters(n.id,n);case 5:r.t1=r.sent,r.t0.setInterfaces.call(r.t0,r.t1);case 7:case"end":return r.stop()}},r,t)}))()},setInterfaces:function(e){this.node.url=e.url,this.node.method=e.method,this.node.java=e.java,this.node.sleep=e.sleep,this.node.parameters=e.parameters,this.node.javascript=e.javascript,this.node.preParams=e.preParams||[],e.returns?(this.node.returns=JSON.parse(e.returns),this.generatedReturns=Object(c.d)(this.node.returns,this.node.java.wrapper)):(this.node.returns=null,this.generatedReturns=null),e.end&&this.$set(this.node,"headers",e.end.header?JSON.parse(e.end.header):[]),this.loadCusInterfacesItem(e.id)},open:function(e,t){var r=e.data||{};this.nodeId=e.id,this.node.interfaceId=r.interfaceId,this.node.interfaceName=r.interfaceName,this.node.history=r.history||!1,this.node.hash=r.hash,this.node.headers=r.headers||[],this.node.parameters=r.parameters||[],this.node.preParams=r.preParams||[],this.node.javascript=r.javascript,this.node.java=r.java,this.node.url=r.url,this.node.sleep=r.sleep,this.node.method=r.method,r.returns?(this.node.returns=r.returns,this.generatedReturns=Object(c.d)(this.node.returns,this.node.java.wrapper)):(this.node.returns=null,this.generatedReturns=null),this.$refs.editNodeDialog.open()},confirm:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.onOk&&e.onOk(a()({},e.node)),e.$refs.editNodeDialog.close())})},paste:function(e){Object(c.a)(e,this.node.parameters)},addHeader:function(){this.node.headers.push({key:"",value:""})},delHeader:function(e){this.node.headers.splice(e,1)}},mounted:function(){this.$el.addEventListener("paste",this.paste)},components:{"v-dialog":function(){return r.e(31).then(r.bind(null,"j9Pd"))},"v-selector":function(){return r.e(30).then(r.bind(null,"qNHp"))},"v-jsonformatter":function(){return r.e(33).then(r.bind(null,"9YOq"))},"v-parameter-input":function(){return r.e(36).then(r.bind(null,"WfCw"))}}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-dialog",{ref:"editNodeDialog",attrs:{title:"配置节点，当前节点编号："+e.nodeId,ok:e.confirm,width:1e3}},[r("el-form",{ref:"form",staticClass:"edit-node-dialog",attrs:{slot:"body",model:e.node,"label-width":"8em"},slot:"body"},[r("el-form-item",{attrs:{prop:"interfaceId",label:"选择一个接口",required:"",rules:[{required:!0,message:"请选择一个接口",trigger:["blur","change"]}]}},[r("v-selector",{staticStyle:{width:"666px"},attrs:{id:"id",text:"complexName",searchKey:"name",onSelectionChanged:e.onSelectInterface,filterable:!0,remote:!0,placeholder:"请选择一个接口（可输入名称进行搜索）",load:e.node.interfaceId?[e.node.interfaceId]:null,url:e.interfacesSimpleListApi}}),e._v(" "),r("el-input",{staticClass:"hidden",model:{value:e.node.interfaceId,callback:function(t){e.$set(e.node,"interfaceId",t)},expression:"node.interfaceId"}}),e._v(" "),r("el-checkbox",{model:{value:e.node.history,callback:function(t){e.$set(e.node,"history",t)},expression:"node.history"}},[e._v("使用历史版本")])],1),e._v(" "),e.node.history?r("el-form-item",{attrs:{label:"历史接口"}},[r("v-selector",{attrs:{id:"hash",text:"name",onSelectionChanged:e.onSelectHistoryInterface,placeholder:"请选择一个历史版本（不选择，当前接口作为副本）",remote:!0,load:e.node.hash?[e.node.hash]:null,url:e.interfacesVersionedSimpleListApi,extraParams:e.node.interfaceId?{interfacesId:e.node.interfaceId}:{interfacesId:-1}}})],1):e._e(),e._v(" "),e.customInterfacesId?r("el-form-item",{attrs:{label:"已存用例"}},[r("v-selector",{staticStyle:{width:"400px"},attrs:{id:"id",text:"name",searchKey:"name",onSelectionChanged:e.onSelectCusInterfacesItem,placeholder:"请选择一个历史保存的用例",remote:!0,filterable:!0,url:e.getCusInterfacesItemListApi,extraParams:e.customInterfacesId?{customInterfacesId:e.customInterfacesId,rows:20}:{customInterfacesId:-1}}})],1):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"访问类型:"}},[r("div",[e._v(e._s(e.node.method))])]):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"接口地址:"}},[r("div",[e._v(e._s(e.node.url))])]):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"休眠"}},[r("el-input",{staticStyle:{display:"inline-block",width:"100px"},attrs:{placeholder:"0"},model:{value:e.node.sleep,callback:function(t){e.$set(e.node,"sleep",t)},expression:"node.sleep"}}),e._v("　秒之后运行\n        ")],1):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"必备Header:"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:"",size:"small"},on:{click:function(t){return e.addHeader()}}}),e._v(" "),e.node.headers?r("el-form",e._l(e.node.headers,function(t,n){return r("el-form-item",{key:n},[r("el-input",{staticClass:"param-key",attrs:{placeholder:"请输入headers参数名"},model:{value:t.key,callback:function(r){e.$set(t,"key",r)},expression:"h.key"}},[r("template",{slot:"prepend"},[r("span",[e._v("参数名")])])],2),e._v(" "),r("span",{staticClass:"v-top"},[e._v("=")]),e._v(" "),r("el-input",{staticClass:"param-value",attrs:{placeholder:"请输入headers参数值"},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"h.value"}},[r("template",{slot:"prepend"},[r("span",[e._v("参数值")])])],2),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"small"},on:{click:function(t){return e.delHeader(n)}}})],1)}),1):e._e()],1):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"预置参数:"}},[r("v-parameter-input",{attrs:{parameters:e.node.preParams}})],1):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"接口参数:"}},[r("v-parameter-input",{attrs:{parameters:e.node.parameters}})],1):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"返回值数据结构:"}},[e.generatedReturns?r("v-jsonformatter",{attrs:{json:e.generatedReturns,"min-height":100}}):e._e()],1):e._e(),e._v(" "),e.node.interfaceId?r("el-form-item",{attrs:{label:"检查点:"}},[r("el-input",{attrs:{placeholder:"注：本接口的调用结果将存入$"+e.nodeId+"和this中。\n另外可以获取上游节（以及上游的上游）点带来的数据，如：$anotherNode.xx\n在这里写入一些检查点脚本，示例：\n\nassert(this.name != null, '返回名称不能为空！')\nassert($"+e.nodeId+".id != null, '返回id不能为空！')\nassert($"+e.nodeId+".quantity > 0, '数量必须大于等于零！')\n\n如果报错了，那么整个流程将被终止。",rows:18,type:"textarea"},model:{value:e.node.javascript,callback:function(t){e.$set(e.node,"javascript",t)},expression:"node.javascript"}})],1):e._e()],1)],1)],1)},staticRenderFns:[]};var f=r("C7Lr")(u,p,!1,function(e){r("is6K")},"data-v-19afd627",null);t.default=f.exports},is6K:function(e,t){}});
//# sourceMappingURL=45.4ae5fab958b9eab76510.js.map