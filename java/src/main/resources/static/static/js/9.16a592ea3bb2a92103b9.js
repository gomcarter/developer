webpackJsonp([9],{QP0I:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("3cXf"),r=i.n(n),a=i("0Njg"),s=i("R2SV"),o={name:"packageView",data:function(){var t=this;return{initialized:!1,disabled:!1,data:{id:null,name:null,userName:null,mark:null},interfacesList:[],workflow:null,pageable:!1,params:{},toolbar:[{title:"导入接口",icon:"el-icon-plus",handler:function(){return t.$refs.chooseInterfacesDialog.open()}},{title:"删除",icon:"el-icon-delete",handler:this.delete}],columns:[{field:"action",header:"操作",width:130,html:!0,actions:[{text:function(t){return'<a href="#/interfaces/view/'+t.id+'" target="_blank">查看</a>'}},{text:"复制",handler:function(e){return t.copy(e)}}]},{field:"id",header:"编号",sort:"id",width:80},{field:"name",header:"接口名称",sort:"name",width:200},{field:"method",header:"METHOD",sort:"method",width:80},{field:"deprecated",header:"废弃",sort:"deprecated",html:!0,width:80,formatter:function(t,e,i){return i?"是".fontcolor("red"):"否"}},{field:"controller",header:"控制器",sort:"controller",width:200},{field:"url",header:"URL",sort:"url",width:120},{field:"java.name",header:"后端服务",sort:"fk_java_id",width:120},{field:"end.name",header:"前端项目",sort:"fk_end_id",width:160},{field:"modifyTime",header:"更新时间",sort:"modify_time",width:200,formatter:function(t,e,i){return Object(s.b)(i)}}]}},mounted:function(){var t=this;window.tta=this,this.width=this.$el.clientWidth-100,this.$route.params.id&&Object(a.L)(this.$route.params.id).then(function(e){t.data=e,t.workflow=t.data.config?JSON.parse(t.data.config):null,t.initialized=!0,Object(a.S)({rows:1e3,idList:t.data.interfacesIdList}).then(function(e){t.interfacesList=e})})},methods:{copy:function(t){var e=this,i=t.url.replaceAll("-","/").split("/").filter(function(t){return t}).map(function(t){return t[0].toUpperCase()+t.substr(1)}).join("");this.$copyText(","+(i[0].toLowerCase()+i.substr(1))+":'"+t.url+"'").then(function(t){return e.$success("复制成功！")},function(t){return e.$success("复制失败！")})},delete:function(){var t=this,e=this.$refs.dg.getSelected();0!==e.length?this.$confirm("你即将删除节点，图中节点也将被同步删除，是否继续？","提示",{type:"warning"}).then(function(){var i=[];e.forEach(function(e){var n=t.interfacesList.indexOf(e);n>=0&&(t.interfacesList.splice(n,1),i.push(e.id))}),t.$refs.editor.batchDeleteNodes(i),t.$refs.dg.clearSelections()}):this.$alert("请至少选择一个接口","提示",{type:"error"})},run:function(){this.disabled=!0,this.$refs.editor.run()},save:function(){var t=this,e=this.$refs.editor.getWorkflow();Object(a._19)(this.$route.params.id,{interfacesIdList:this.interfacesList.map(function(t){return t.id}),config:e?r()(e):null}).then(function(){t.$transfer({back:"返回编辑",buttons:[{text:"去列表",link:"/package/list"}]})})},finished:function(){this.disabled=!1},onOpen:function(){this.$refs.editor.batchAddNodes(this.interfacesList)},batchImport:function(){var t=this,e=this.$refs.interfacesList.getSelections();if(0!==e.length){var i=e.map(function(t){return t.id}),n=this.interfacesList.map(function(t){return t.id}),r=[];i.forEach(function(t){n.indexOf(t)<0&&r.push(t)}),r.length>0&&Object(a.S)({rows:1e3,idList:r}).then(function(e){t.$success("接口导入成功，重复接口被去除。"),t.$refs.interfacesList.clearSelections(),t.interfacesList=t.interfacesList.concat(e),t.$refs.editor.batchAddNodes(e),t.$refs.chooseInterfacesDialog.close()})}else this.$alert("请至少选择一个接口","提示",{type:"error"})}},components:{"v-datagrid":function(){return i.e(32).then(i.bind(null,"mW4C"))},"v-selector":function(){return i.e(30).then(i.bind(null,"qNHp"))},"v-dialog":function(){return i.e(31).then(i.bind(null,"j9Pd"))},"v-aggregation-editor":function(){return i.e(41).then(i.bind(null,"GiD8"))},"v-interfaces-list":function(){return i.e(1).then(i.bind(null,"vKqz"))}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h4",{staticClass:"title"},[t._v("基本信息")]),t._v(" "),i("hr"),t._v(" "),i("el-form",{attrs:{"label-width":"6em"}},[i("el-form-item",{attrs:{label:"编号："}},[t._v(t._s(t.data.id))]),t._v(" "),i("el-form-item",{attrs:{label:"名称："}},[t._v(t._s(t.data.name))]),t._v(" "),i("el-form-item",{attrs:{label:"创建人："}},[t._v(t._s(t.data.userName))]),t._v(" "),i("el-form-item",{attrs:{label:"备注："}},[i("div",{staticClass:"mark"},[t._v(t._s(t.data.mark))])])],1),t._v(" "),i("h4",{staticClass:"title"},[t._v("打包接口列表")]),t._v(" "),i("hr"),t._v(" "),t.data&&t.data.id?i("v-datagrid",{ref:"dg",attrs:{columns:t.columns,checkable:!0,pageable:!1,"load-data":t.interfacesList,toolbar:t.toolbar}}):t._e(),t._v(" "),i("h4",{staticClass:"title",staticStyle:{"margin-top":"40px"}},[t._v("接口自动聚合")]),t._v(" "),i("hr"),t._v(" "),i("el-form",[i("el-form-item",[t.initialized?i("v-aggregation-editor",{ref:"editor",attrs:{workflow:t.workflow,"on-open":t.onOpen}}):t._e()],1),t._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"info",icon:"el-icon-back"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")]),t._v(" "),i("el-button",{attrs:{type:"success",icon:"el-icon-check"},on:{click:t.save}},[t._v("保存")]),t._v(" "),i("el-button",{attrs:{type:"success",icon:t.disabled?"el-icon-loading":"el-icon-magic-stick",disabled:t.disabled},on:{click:t.run}},[t._v("测试运行")])],1)],1),t._v(" "),i("v-dialog",{ref:"chooseInterfacesDialog",attrs:{title:"选择接口",ok:t.batchImport,width:1300}},[i("div",{staticStyle:{height:"600px",overflow:"auto"},attrs:{slot:"body"},slot:"body"},[i("v-interfaces-list",{ref:"interfacesList",attrs:{"no-toolbar":!0}})],1)])],1)},staticRenderFns:[]};var c=i("C7Lr")(o,l,!1,function(t){i("TLLd")},"data-v-e529e8b2",null);e.default=c.exports},TLLd:function(t,e){}});
//# sourceMappingURL=9.16a592ea3bb2a92103b9.js.map