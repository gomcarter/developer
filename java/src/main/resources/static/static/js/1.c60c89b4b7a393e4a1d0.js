webpackJsonp([1],{bNAC:function(e,t){},vKqz:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("aA9S"),l=r.n(n),a=r("0Njg"),i=r("R2SV"),o={name:"interfaces",props:{noToolbar:{type:Boolean,default:!1}},data:function(){var e=this;return{form:{name:null,mark:null},endListApi:a.v,javaListApi:a.X,filter:{id:null,name:null,deprecated:null,url:null,controller:null,javaId:null,endId:null},dataUrl:a.S,countUrl:a.R,params:{},selected:[],toolbar:e.noToolbar?null:[{title:"手动录入接口",icon:"el-icon-plus",handler:function(){return e.$router.push("/interfaces/edit")}},{title:"接口打包",icon:"el-icon-box",disabled:function(){return 0===e.selected.length},handler:function(){return e.$refs.packageDialog.open()}},{title:"作废",icon:"el-icon-delete",disabled:function(){return 0===e.selected.length},handler:e.delete}],columns:[{field:"action",header:"操作",width:160,html:!0,actions:[{text:function(e){return'<a href="#/test/'+e.id+'/testDomain" target="_blank">执行</a>'}},{text:function(){return'<span title="沙老师需求">复制</span>'},handler:function(t){return e.copy(t)}}]},{field:"id",header:"编号",sort:"id",width:80},{field:"name",header:"接口名称",sort:"name",width:200,html:!0,formatter:function(e,t,r){return'<a href="#/interfaces/view/'+e.id+'" target="_blank">'+r+"</a>"}},{field:"method",header:"METHOD",sort:"method",width:80},{field:"deprecated",header:"废弃",sort:"deprecated",html:!0,width:80,formatter:function(e,t,r){return r?"是".fontcolor("red"):"否"}},{field:"controller",header:"控制器",sort:"controller",width:180},{field:"url",header:"URL",sort:"url",width:120},{field:"java.name",header:"后端服务",sort:"fk_java_id",width:120},{field:"end.name",header:"前端项目",sort:"fk_end_id",width:160},{field:"modifyTime",header:"更新时间",sort:"modify_time",width:200,formatter:function(e,t,r){return Object(i.b)(r)}}],selectedColumns:[{field:"id",header:"编号",width:80},{field:"name",header:"接口名称",width:200},{field:"url",header:"URL",width:350},{field:"java.name",header:"后端服务",width:120},{field:"end.name",header:"前端项目",width:160}]}},mounted:function(){window.that=this},methods:{transfer:function(e){var t=this;e.transfered||Object(a.e)(e.id).then(function(){t.$success("收藏成功，可以在【接口自动化测试】>【我的接口列表】查看！"),e.transfered=!0,t.$refs.dg.render()})},copy:function(e){var t=this,r=e.url.replaceAll("-","/").split("/").filter(function(e){return e}).map(function(e){return e[0].toUpperCase()+e.substr(1)}).join("");this.$copyText(","+(r[0].toLowerCase()+r.substr(1))+":'"+e.url+"'").then(function(e){return t.$success("复制成功！")},function(e){return t.$success("复制失败！")})},delete:function(){var e=this;this.$confirm("确认作废吗？","提示",{type:"warning"}).then(function(){Object(a.i)(e.selected.map(function(e){return e.id})).then(function(){e.$success("作废成功！"),e.search()})})},commitPackage:function(){var e=this;this.$refs.packageForm.validate(function(t){t&&Object(a.g)(l()({interfacesIdList:e.selected.map(function(e){return e.id})},e.form)).then(function(t){e.form.name=null,e.form.mark=null,e.clearSelections(),e.$refs.packageDialog.close(),e.$confirm("打包成功！","提示",{type:"success",cancelButtonText:"关闭",confirmButtonText:"去查看"}).then(function(){e.$router.push("/package/view/"+t)})})})},onSelectionChanged:function(e){var t=this;this.selected.length=0,(e||[]).forEach(function(e){t.selected.push(e)})},getSelections:function(){return this.selected.map(function(e){return e})},clearSelections:function(){this.$refs.dg.clearSelections()},search:function(){this.params=Object(i.g)(this.filter)},clear:function(){this.params={},this.filter={},this.$refs.back.clear(),this.$refs.front.clear()}},components:{"v-datagrid":function(){return r.e(32).then(r.bind(null,"mW4C"))},"v-selector":function(){return r.e(30).then(r.bind(null,"qNHp"))},"v-dialog":function(){return r.e(31).then(r.bind(null,"j9Pd"))}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h4",{staticClass:"title"},[e._v("筛选条件")]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"filters"},[r("el-form",{attrs:{inline:!0,model:e.filter,"label-width":"6em"}},[r("el-form-item",{attrs:{label:"编号"}},[r("el-input",{attrs:{type:"number",placeholder:"请输入编号"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.id,callback:function(t){e.$set(e.filter,"id",t)},expression:"filter.id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"接口名称"}},[r("el-input",{attrs:{placeholder:"请输入接口名称"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.name,callback:function(t){e.$set(e.filter,"name",t)},expression:"filter.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"控制器"}},[r("el-input",{attrs:{placeholder:"请输入控制器"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.controller,callback:function(t){e.$set(e.filter,"controller",t)},expression:"filter.controller"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"URL"}},[r("el-input",{attrs:{placeholder:"请输入URL"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.url,callback:function(t){e.$set(e.filter,"url",t)},expression:"filter.url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否废弃"}},[r("v-selector",{attrs:{data:{true:"是",false:"否"},onSelectionChanged:function(t){return e.filter.deprecated=(t[0]||{}).id},placeholder:"请选择是否废弃"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"后端服务"}},[r("v-selector",{ref:"back",attrs:{id:"id",text:"name",onSelectionChanged:function(t){return e.filter.javaId=(t[0]||{}).id},filterable:!0,remote:!0,placeholder:"请选择后端服务（可输入名称进行搜索）",url:e.javaListApi}})],1),e._v(" "),r("el-form-item",{attrs:{label:"前端项目"}},[r("v-selector",{ref:"front",attrs:{id:"id",text:"name",onSelectionChanged:function(t){return e.filter.endId=(t[0]||{}).id},filterable:!0,remote:!0,placeholder:"请选择前端项目（可输入名称进行搜索）",url:e.endListApi}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),r("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.clear}},[e._v("清空")])],1)],1)],1),e._v(" "),r("h4",{staticClass:"title"},[e._v("接口列表")]),e._v(" "),r("hr"),e._v(" "),r("v-datagrid",{ref:"dg",attrs:{columns:e.columns,"data-url":e.dataUrl,"count-url":e.countUrl,params:e.params,checkable:!0,toolbar:e.toolbar,onSelectionChanged:e.onSelectionChanged}}),e._v(" "),r("v-dialog",{ref:"packageDialog",attrs:{title:"接口打包",width:1e3,ok:e.commitPackage}},[r("el-form",{ref:"packageForm",attrs:{slot:"body",model:e.form,"label-width":"7em"},slot:"body"},[r("div",{staticClass:"mark margin-bottom20"},[e._v("一个功能（或者一个页面，需求）的多个接口打包在一起，方便集中管理和查阅")]),e._v(" "),r("el-form-item",{attrs:{prop:"name",label:"打包名称",required:"",rules:[{required:!0,message:"请输入名称",trigger:["blur","change"]}]}},[r("el-input",{attrs:{placeholder:"请输入名称，比如：某某页面接口集合"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入备注",rows:"4"},model:{value:e.form.mark,callback:function(t){e.$set(e.form,"mark",t)},expression:"form.mark"}})],1),e._v(" "),r("v-datagrid",{attrs:{columns:e.selectedColumns,"load-data":e.selected,pageable:!1,height:400}}),e._v(" "),r("hr")],1)],1)],1)},staticRenderFns:[]};var s=r("C7Lr")(o,c,!1,function(e){r("bNAC")},"data-v-716fc498",null);t.default=s.exports}});
//# sourceMappingURL=1.c60c89b4b7a393e4a1d0.js.map