{"version":3,"sources":["webpack:///./src/config/api/data-api.js","webpack:///src/components/table-output-editor/index.vue","webpack:///./src/components/table-output-editor/index.vue?a673","webpack:///./src/components/table-output-editor/index.vue"],"names":["tableMap","1","name","schema","2","3","4","tableListApi","params","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default","a","resolve","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_entries___default","map","s","id","tableInfoApi","tableId","columns","column","type","comment","Date","now","description","table_output_editor","props","onOk","Function","default","data","library","data_api","tableInfo","aggregationDataList","fixedColumns","customColumns","joinTypeList","conditionList","field","header","width","html","actions","text","handler","row","node","aggregation","methods","onSelectCustomColumn","onLibraryClicked","addCustomColumn","this","push","deleteCustomColumn","index","splice","addJoinType","deleteJoinType","addCondition","deleteCondition","onSelectAggregation","selections","console","log","onSelectTable","_this","asyncToGenerator_default","regenerator_default","mark","_callee","selection","wrap","_context","prev","next","Object","then","res","stop","setInterfaces","open","n","model","getModel","getEdges","getSource","filter","flatMap","length","$refs","editNodeDialog","$alert","confirm","_this2","form","validate","valid","assign_default","close","mounted","window","tt","components","v-dialog","__webpack_require__","e","bind","v-selector","v-datagrid","components_table_output_editor","render","_vm","_h","$createElement","_c","_self","ref","attrs","title","ok","slot","staticClass","label-width","prop","label","value","callback","$$v","$set","expression","_v","required","rules","message","trigger","staticStyle","searchKey","onSelectionChanged","multiple","filterable","placeholder","load","_e","_l","fc","fi","key","_s","cc","ci","mapper","icon","circle","size","on","click","$event","jl","ji","leftColumn","joinType","rightColumn","cl","cli","staticRenderFns","Component","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/43.6988cdffea70b18e4d71.js","sourcesContent":["\nconst tableMap = {\n  1: {\n    name: '订单主表',\n    schema: 'order'\n  },\n  2: {\n    name: '订单商品主表',\n    schema: 'order'\n  },\n  3: {\n    name: '商品主表',\n    schema: 'order'\n  },\n  4: {\n    name: '优惠券主表',\n    schema: 'order'\n  }\n}\n\nexport const tableListApi = (params) => {\n  return Promise.resolve(Object.entries(tableMap)\n    .map(s => {\n      return {\n        id: +s[0],\n        name: s[1].name\n      }\n    })\n  )\n}\n\nexport const tableInfoApi = (tableId) => {\n  return Promise.resolve({\n    columns: [{\n      name: '字段' + 1,\n      column: 'column' + 1,\n      type: '类型',\n      comment: '备注' + Date.now()\n    }, {\n      name: '字段' + 2,\n      column: 'column' + 2,\n      type: '类型',\n      comment: '备注' + Date.now()\n    }, {\n      name: '字段' + 3,\n      column: 'column' + 3,\n      type: '类型',\n      comment: '备注' + Date.now()\n    }, {\n      name: '字段' + 4,\n      column: 'column' + 4,\n      type: '类型',\n      comment: '备注' + Date.now()\n    }],\n    id: tableId,\n    name: tableMap[tableId].name,\n    description: '主表，相关的数据'\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/api/data-api.js","<template>\n  <div>\n    <v-dialog ref=\"editNodeDialog\" title=\"组合表\" :ok=\"confirm\" :width=\"1000\">\n      <div slot=\"body\">\n        <el-form ref=\"form\" :model=\"node\" label-width=\"8em\" class=\"edit-node-dialog\">\n          <el-form-item prop=\"aggregation\" label=\"聚合：\" >\n            <el-switch v-model=\"node.aggregation\">\n            </el-switch>\n          </el-form-item>\n          <el-form-item v-if=\"node.aggregation\" label=\"聚合维度:\" required\n                        :rules=\"[{ required: true, message: '请至少选择一个聚合维度', trigger: ['blur', 'change'] }]\">\n            <v-selector v-if=\"aggregationDataList.length > 0\"\n                        :id=\"'column'\" :text=\"'text'\" :searchKey=\"'name'\" style=\"width: 666px;\"\n                        :onSelectionChanged=\"onSelectAggregation\" :multiple=\"true\"\n                        :filterable=\"true\" placeholder=\"请选择聚合维度\"\n                        :load=\"node.tableId ? [node.tableId] : null\"\n                        :data=\"aggregationDataList\"\n            ></v-selector>\n          </el-form-item>\n          <el-form-item v-if=\"node.aggregation\" prop=\"tableId\" label=\"数据指标:\"  required\n                        :rules=\"[{ required: true, message: '请选择一个表', trigger: ['blur', 'change'] }]\">\n            <el-form>\n              <el-form-item v-for=\"(fc, fi) in fixedColumns\" :key=\"'fixedColumns_' + fi\">\n                <div>{{fc.text}}</div>\n              </el-form-item>\n              <el-form v-if=\"customColumns\">\n                <el-form-item v-for=\"(cc, ci) of customColumns\" :key=\"'customColumns_' + ci\">\n                  <v-selector :id=\"'column'\" :text=\"'text'\" :searchKey=\"'name'\" style=\"width: 200px\"\n                              :onSelectionChanged=\"onSelectCustomColumn\"\n                              :filterable=\"true\" placeholder=\"请选择需要的指标\"\n                              :load=\"cc.column ? [cc.column] : null\"\n                              :data=\"aggregationDataList\"\n                  ></v-selector>\n                  <v-selector style=\"width: 100px\"\n                              placeholder=\"选择转换算法\"\n                              :load=\"cc.column ? [cc.column] : ['不转换']\"\n                              :data=\"[{id: '不转换', text: '不转换'},{id: '转换', text: '转换'}, {id: '聚合', text: '聚合'}]\"\n                  ></v-selector>\n                  <v-selector :onSelectionChanged=\"onSelectCustomColumn\" style=\"width: 100px\"\n                              placeholder=\"选择转换算法\"\n                              :load=\"cc.mapper ? [cc.mapper] : ['算法1']\"\n                              :data=\"[{id: '算法1', text: '算法1'},{id: '算法2', text: '算法2'}, {id: '算法3', text: '算法3'}]\"\n                  ></v-selector>\n                  <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"deleteCustomColumn(ci)\" circle size=\"small\"></el-button>\n                </el-form-item>\n                <el-form-item>\n                  <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"addCustomColumn()\" circle size=\"small\"></el-button>\n                </el-form-item>\n              </el-form>\n            </el-form>\n          </el-form-item>\n          <el-form-item v-if=\"node.aggregation\" label=\"连接:\" required\n                        :rules=\"[{ required: true, message: '请至少选择一个聚合维度', trigger: ['blur', 'change'] }]\">\n            <el-form v-if=\"joinTypeList\">\n              <el-form-item v-for=\"(jl, ji) of joinTypeList\" :key=\"'joinTypeList_' + ji\">\n                <v-selector :id=\"'column'\" :text=\"'text'\" :searchKey=\"'name'\" style=\"width: 200px\"\n                            :onSelectionChanged=\"onSelectCustomColumn\"\n                            :filterable=\"true\" placeholder=\"请选择需要的指标\"\n                            :load=\"jl.leftColumn ? [jl.leftColumn] : null\"\n                            :data=\"aggregationDataList\"\n                ></v-selector>\n                <v-selector :onSelectionChanged=\"onSelectCustomColumn\" style=\"width: 200px\"\n                            placeholder=\"选择连接方式\"\n                            :load=\"jl.joinType ? [jl.joinType] : null\"\n                            :data=\"[{id: '内联', text: '内联'},{id: '左联', text: '左联'}]\"\n                ></v-selector>\n                <v-selector :id=\"'column'\" :text=\"'text'\" :searchKey=\"'name'\" style=\"width: 200px\"\n                            :onSelectionChanged=\"onSelectCustomColumn\"\n                            :filterable=\"true\" placeholder=\"请选择需要的指标\"\n                            :load=\"jl.rightColumn ? [jl.rightColumn] : null\"\n                            :data=\"aggregationDataList\"\n                ></v-selector>\n                <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"deleteJoinType(jl)\" circle size=\"small\"></el-button>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"addJoinType()\" circle size=\"small\"></el-button>\n              </el-form-item>\n            </el-form>\n          </el-form-item>\n          <el-form-item v-if=\"node.aggregation\" label=\"条件:\" required\n                        :rules=\"[{ required: true, message: '请至少选择一个聚合维度', trigger: ['blur', 'change'] }]\">\n            <el-form v-if=\"conditionList\">\n              <el-form-item v-for=\"(cl, cli) of conditionList\" :key=\"'conditionList_' + cli\">\n                <v-selector :id=\"'column'\" :text=\"'text'\" :searchKey=\"'name'\" style=\"width: 200px\"\n                            :onSelectionChanged=\"onSelectCustomColumn\"\n                            :filterable=\"true\" placeholder=\"请选择需要的指标\"\n                            :load=\"cl.leftColumn ? [cl.leftColumn] : null\"\n                            :data=\"aggregationDataList\"\n                ></v-selector>\n                <v-selector :onSelectionChanged=\"onSelectCustomColumn\" style=\"width: 200px\"\n                            placeholder=\"选择连接方式\"\n                            :load=\"cl.joinType ? [cl.joinType] : null\"\n                            :data=\"[{id: '>', text: '>'},{id: '=', text: '='},{id: '<', text: '<'},{id: 'in', text: 'in'}]\"\n                ></v-selector>\n                <v-selector :id=\"'column'\" :text=\"'text'\" :searchKey=\"'name'\" style=\"width: 200px\"\n                            :onSelectionChanged=\"onSelectCustomColumn\"\n                            :filterable=\"true\" placeholder=\"请选择需要的指标\"\n                            :load=\"cl.rightColumn ? [cl.rightColumn] : null\"\n                            :data=\"aggregationDataList\"\n                ></v-selector>\n                <el-button type=\"danger\" icon=\"el-icon-delete\" @click=\"deleteCondition(cl)\" circle size=\"small\"></el-button>\n              </el-form-item>\n              <el-form-item>\n                <el-button type=\"primary\" icon=\"el-icon-plus\" @click=\"addCondition()\" circle size=\"small\"></el-button>\n              </el-form-item>\n            </el-form>\n          </el-form-item>\n        </el-form>\n      </div>\n    </v-dialog>\n  </div>\n</template>\n\n<script>\nimport { tableListApi, tableInfoApi } from '@/config/api/data-api'\n\nexport default {\n  props: {\n    onOk: {\n      type: Function,\n      default: () => {}\n    }\n  },\n  data () {\n    return {\n      library: 'publics',\n      tableListApi,\n      tableInfoApi,\n      tableInfo: null,\n      aggregationDataList: [],\n      fixedColumns: [],\n      customColumns: [],\n      joinTypeList: [],\n      conditionList: [],\n      columns: [\n        {field: 'name', header: '字段名', width: 100},\n        {field: 'type', header: '类型', width: 100},\n        {field: 'comment', header: '说明', width: 300},\n        {\n          field: 'action',\n          header: '操作',\n          width: 80,\n          html: true,\n          actions: [{\n            text: '【删除】',\n            handler: (row) => {}\n          }]\n        }\n      ],\n      node: {\n        aggregation: false,\n        tableId: null\n      }\n    }\n  },\n  methods: {\n    onSelectCustomColumn () {\n\n    },\n    onLibraryClicked () {\n\n    },\n    addCustomColumn () {\n      this.customColumns.push({})\n    },\n    deleteCustomColumn (index) {\n      this.customColumns.splice(index, 1)\n    },\n    addJoinType () {\n      this.joinTypeList.push({})\n    },\n    deleteJoinType (index) {\n      this.joinTypeList.splice(index, 1)\n    },\n    addCondition () {\n      this.conditionList.push({})\n    },\n    deleteCondition (index) {\n      this.conditionList.splice(index, 1)\n    },\n    onSelectAggregation (selections) {\n      console.log(selections)\n      this.fixedColumns = selections.map(s => s)\n    },\n    async onSelectTable (selections) {\n      const selection = selections[0] || {}\n      this.node.tableId = selection.id\n      this.node.name = selection.name\n\n      tableInfoApi(this.node.tableId)\n        .then(res => {\n          this.tableInfo = res\n        })\n    },\n    setInterfaces (selection) {\n    },\n    open (node) {\n      this.n = node\n      const model = node.getModel()\n      console.log(node.getEdges())\n      console.log(model)\n      // 获取接入节点\n      this.aggregationDataList = node.getEdges()\n        .map(s => s.getSource())\n        .filter(s => s !== node)\n        .map(s => {\n          const data = s.getModel().data\n          if (data) {\n            data.columns = data.columns.map(s => {\n              s.text = data.name + '.' + s.name\n              return s\n            })\n          }\n          return data\n        })\n        .filter(s => s)\n        .flatMap(s => s.columns)\n\n      console.log(this.aggregationDataList)\n\n      if (this.aggregationDataList.length === 0) {\n        this.$alert('请先设置接入表！', '提示', {type: 'error'})\n        return\n      }\n      console.log(this.aggregationDataList)\n\n      this.$refs.editNodeDialog.open()\n    },\n    confirm () {\n      this.$refs.form.validate((valid) => {\n        if (valid) {\n          this.onOk && this.onOk(Object.assign({}, this.node))\n          this.$refs.editNodeDialog.close()\n        }\n      })\n    }\n  },\n  mounted () {\n    window.tt = this\n  },\n  components: {\n    'v-dialog': () => import('@/components/dialog'),\n    'v-selector': () => import('@/components/selector'),\n    'v-datagrid': () => import('@/components/datagrid')\n  }\n}\n</script>\n\n<style type=\"text/css\" lang=\"scss\" scoped>\n  @import 'index';\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/table-output-editor/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('v-dialog',{ref:\"editNodeDialog\",attrs:{\"title\":\"组合表\",\"ok\":_vm.confirm,\"width\":1000}},[_c('div',{attrs:{\"slot\":\"body\"},slot:\"body\"},[_c('el-form',{ref:\"form\",staticClass:\"edit-node-dialog\",attrs:{\"model\":_vm.node,\"label-width\":\"8em\"}},[_c('el-form-item',{attrs:{\"prop\":\"aggregation\",\"label\":\"聚合：\"}},[_c('el-switch',{model:{value:(_vm.node.aggregation),callback:function ($$v) {_vm.$set(_vm.node, \"aggregation\", $$v)},expression:\"node.aggregation\"}})],1),_vm._v(\" \"),(_vm.node.aggregation)?_c('el-form-item',{attrs:{\"label\":\"聚合维度:\",\"required\":\"\",\"rules\":[{ required: true, message: '请至少选择一个聚合维度', trigger: ['blur', 'change'] }]}},[(_vm.aggregationDataList.length > 0)?_c('v-selector',{staticStyle:{\"width\":\"666px\"},attrs:{\"id\":'column',\"text\":'text',\"searchKey\":'name',\"onSelectionChanged\":_vm.onSelectAggregation,\"multiple\":true,\"filterable\":true,\"placeholder\":\"请选择聚合维度\",\"load\":_vm.node.tableId ? [_vm.node.tableId] : null,\"data\":_vm.aggregationDataList}}):_vm._e()],1):_vm._e(),_vm._v(\" \"),(_vm.node.aggregation)?_c('el-form-item',{attrs:{\"prop\":\"tableId\",\"label\":\"数据指标:\",\"required\":\"\",\"rules\":[{ required: true, message: '请选择一个表', trigger: ['blur', 'change'] }]}},[_c('el-form',[_vm._l((_vm.fixedColumns),function(fc,fi){return _c('el-form-item',{key:'fixedColumns_' + fi},[_c('div',[_vm._v(_vm._s(fc.text))])])}),_vm._v(\" \"),(_vm.customColumns)?_c('el-form',[_vm._l((_vm.customColumns),function(cc,ci){return _c('el-form-item',{key:'customColumns_' + ci},[_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"id\":'column',\"text\":'text',\"searchKey\":'name',\"onSelectionChanged\":_vm.onSelectCustomColumn,\"filterable\":true,\"placeholder\":\"请选择需要的指标\",\"load\":cc.column ? [cc.column] : null,\"data\":_vm.aggregationDataList}}),_vm._v(\" \"),_c('v-selector',{staticStyle:{\"width\":\"100px\"},attrs:{\"placeholder\":\"选择转换算法\",\"load\":cc.column ? [cc.column] : ['不转换'],\"data\":[{id: '不转换', text: '不转换'},{id: '转换', text: '转换'}, {id: '聚合', text: '聚合'}]}}),_vm._v(\" \"),_c('v-selector',{staticStyle:{\"width\":\"100px\"},attrs:{\"onSelectionChanged\":_vm.onSelectCustomColumn,\"placeholder\":\"选择转换算法\",\"load\":cc.mapper ? [cc.mapper] : ['算法1'],\"data\":[{id: '算法1', text: '算法1'},{id: '算法2', text: '算法2'}, {id: '算法3', text: '算法3'}]}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"circle\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteCustomColumn(ci)}}})],1)}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-plus\",\"circle\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.addCustomColumn()}}})],1)],2):_vm._e()],2)],1):_vm._e(),_vm._v(\" \"),(_vm.node.aggregation)?_c('el-form-item',{attrs:{\"label\":\"连接:\",\"required\":\"\",\"rules\":[{ required: true, message: '请至少选择一个聚合维度', trigger: ['blur', 'change'] }]}},[(_vm.joinTypeList)?_c('el-form',[_vm._l((_vm.joinTypeList),function(jl,ji){return _c('el-form-item',{key:'joinTypeList_' + ji},[_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"id\":'column',\"text\":'text',\"searchKey\":'name',\"onSelectionChanged\":_vm.onSelectCustomColumn,\"filterable\":true,\"placeholder\":\"请选择需要的指标\",\"load\":jl.leftColumn ? [jl.leftColumn] : null,\"data\":_vm.aggregationDataList}}),_vm._v(\" \"),_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"onSelectionChanged\":_vm.onSelectCustomColumn,\"placeholder\":\"选择连接方式\",\"load\":jl.joinType ? [jl.joinType] : null,\"data\":[{id: '内联', text: '内联'},{id: '左联', text: '左联'}]}}),_vm._v(\" \"),_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"id\":'column',\"text\":'text',\"searchKey\":'name',\"onSelectionChanged\":_vm.onSelectCustomColumn,\"filterable\":true,\"placeholder\":\"请选择需要的指标\",\"load\":jl.rightColumn ? [jl.rightColumn] : null,\"data\":_vm.aggregationDataList}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"circle\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteJoinType(jl)}}})],1)}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-plus\",\"circle\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.addJoinType()}}})],1)],2):_vm._e()],1):_vm._e(),_vm._v(\" \"),(_vm.node.aggregation)?_c('el-form-item',{attrs:{\"label\":\"条件:\",\"required\":\"\",\"rules\":[{ required: true, message: '请至少选择一个聚合维度', trigger: ['blur', 'change'] }]}},[(_vm.conditionList)?_c('el-form',[_vm._l((_vm.conditionList),function(cl,cli){return _c('el-form-item',{key:'conditionList_' + cli},[_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"id\":'column',\"text\":'text',\"searchKey\":'name',\"onSelectionChanged\":_vm.onSelectCustomColumn,\"filterable\":true,\"placeholder\":\"请选择需要的指标\",\"load\":cl.leftColumn ? [cl.leftColumn] : null,\"data\":_vm.aggregationDataList}}),_vm._v(\" \"),_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"onSelectionChanged\":_vm.onSelectCustomColumn,\"placeholder\":\"选择连接方式\",\"load\":cl.joinType ? [cl.joinType] : null,\"data\":[{id: '>', text: '>'},{id: '=', text: '='},{id: '<', text: '<'},{id: 'in', text: 'in'}]}}),_vm._v(\" \"),_c('v-selector',{staticStyle:{\"width\":\"200px\"},attrs:{\"id\":'column',\"text\":'text',\"searchKey\":'name',\"onSelectionChanged\":_vm.onSelectCustomColumn,\"filterable\":true,\"placeholder\":\"请选择需要的指标\",\"load\":cl.rightColumn ? [cl.rightColumn] : null,\"data\":_vm.aggregationDataList}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"circle\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.deleteCondition(cl)}}})],1)}),_vm._v(\" \"),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-plus\",\"circle\":\"\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.addCondition()}}})],1)],2):_vm._e()],1):_vm._e()],1)],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-3bb18bfc\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/components/table-output-editor/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3bb18bfc\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3bb18bfc\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-3bb18bfc\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/table-output-editor/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}