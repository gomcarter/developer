webpackJsonp([20],{ZPT6:function(e,t){},"l+fO":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r("0Njg"),n=r("R2SV"),i=r("LLxk"),a={data:function(){var e=this;return{isAdmin:Object(i.a)(),currentUser:Object(i.e)(),disabled:!1,setting:{remote:null,url:null},test:{username:"admin",password:"3e27f65cdf23407d9c3a72297567c5fa"},filter:{id:null,username:null,name:null,mail:null,cellphone:null,createTimeGE:null,createTimeLE:null,modifyTimeGE:null,modifyTimeLE:null},dataUrl:l._25,countUrl:l._24,params:{},toolbar:[{title:"新增",icon:"el-icon-plus",handler:function(){return e.$router.push("/system/user/edit")}}],columns:[{field:"id",header:"编号",sort:"id",width:100},{field:"username",header:"账号",sort:"username",width:140},{field:"name",header:"姓名",sort:"name",width:140},{field:"mail",header:"邮箱",sort:"mail",width:200},{field:"cellphone",header:"联系电话",sort:"cellphone",width:140},{field:"createTime",header:"添加时间",sort:"create_time",width:230,formatter:function(e,t,r){return Object(n.b)(r)}},{field:"modifyTime",header:"修改时间",sort:"modify_time",width:230,formatter:function(e,t,r){return Object(n.b)(r)}},{field:"action",header:"操作",width:230,actions:[{text:"【编辑】",show:function(t){return(e.isAdmin||t.username===e.currentUser)&&!Object(i.a)(t.username)},handler:function(t){return e.$router.push("/system/user/edit/"+t.id)}},{text:"【删除】",show:function(t){return e.isAdmin&&!Object(i.a)(t.username)},handler:function(t){return e.delete(t.id)}}]}]}},mounted:function(){this.load()},methods:{openTestDialog:function(){this.$refs.testDialog.open()},load:function(){var e=this;Object(l.Q)().then(function(t){e.setting.remote=t.remote||!1,e.setting.url=t.url}).catch(function(){e.$alert("读取配置数据失败！","提示",{type:"error"})})},remoteChanged:function(){!1===this.setting.remote&&Object(l._23)(this.setting)},doTest:function(){var e=this;Object(l._16)({url:this.setting.url,username:this.test.username,password:this.test.password}).then(function(t){e.$alert("测试登录成功！","提示",{type:"success"})}).catch(function(){})},save:function(){var e=this;this.$refs.settingForm.validate(function(t){t&&(e.disabled=!0,Object(l._23)(e.setting).then(function(t){e.disabled=!1,e.$success("保存成功！"),e.disabled=!1}).catch(function(){e.disabled=!1}))})},delete:function(e){var t=this;this.$confirm("删除将无法恢复，确认删除吗？","提示",{type:"warning"}).then(function(){Object(l.t)(e).then(function(){t.$success("删除成功！"),t.search()})})},search:function(){this.params=Object(n.g)(this.filter)},clear:function(){this.params={},this.filter={}}},components:{"v-dialog":function(){return r.e(31).then(r.bind(null,"j9Pd"))},"v-datagrid":function(){return r.e(32).then(r.bind(null,"mW4C"))},"v-jsonformatter":function(){return r.e(33).then(r.bind(null,"9YOq"))}}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return null!=e.setting.remote?r("div",[e.isAdmin?r("h4",{staticClass:"title"},[e._v("设置")]):e._e(),e._v(" "),e.isAdmin?r("hr"):e._e(),e._v(" "),r("el-form",{attrs:{"label-width":"10em"}},[e.isAdmin?r("el-form-item",{staticClass:"label",attrs:{label:"是否开启外部登录"}},[r("el-switch",{on:{change:e.remoteChanged},model:{value:e.setting.remote,callback:function(t){e.$set(e.setting,"remote",t)},expression:"setting.remote"}})],1):e._e()],1),e._v(" "),!0===e.setting.remote?r("div",[e.isAdmin?r("el-form",{ref:"settingForm",attrs:{model:e.setting,"label-width":"10em"}},[r("el-form-item",{attrs:{label:"登录URL",rules:[{required:!0,message:"请输入登录URL",trigger:["blur","change"]}],prop:"url"}},[r("el-input",{attrs:{placeholder:"请输入登录URL"},model:{value:e.setting.url,callback:function(t){e.$set(e.setting,"url",t)},expression:"setting.url"}})],1),e._v(" "),r("el-form-item",[r("div",{staticClass:"mark"},[e._v("设置url需支持POST请求，且登录用户名参数为：username，密码参数为：password；返回数据结果需要如下：")]),e._v(" "),r("v-jsonformatter",{attrs:{width:600,json:{success:"true/false —— true表示登录成功，false表示登录失败",message:"登录失败原因"},minHeight:100}}),e._v(" "),r("div",{staticClass:"mark red"},[e._v("注意：如果开启了外部登录，但是登录不成功，您依然可以是使用admin账户登录到本系统")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:e.disabled?"el-icon-loading":"el-icon-check",disabled:e.disabled},on:{click:e.save}},[e._v("保存设置")]),e._v(" "),r("el-button",{attrs:{type:"success",icon:"el-icon-s-promotion",disabled:e.disabled},on:{click:e.openTestDialog}},[e._v("测试登录")])],1)],1):r("el-form",{attrs:{"label-width":"10em"}},[r("el-form-item",{staticClass:"label"},[r("h3",[e._v("当前已开启外部登录，用户管理功能被禁用。")])])],1)],1):!1===e.setting.remote?r("div",{style:{"margin-left":e.isAdmin?"4em":""}},[r("h4",{staticClass:"title"},[e._v("筛选条件")]),e._v(" "),r("hr"),e._v(" "),r("div",{staticClass:"filters"},[r("el-form",{attrs:{inline:!0,model:e.filter,"label-width":"6em"}},[r("el-form-item",{attrs:{label:"编号"}},[r("el-input",{attrs:{placeholder:"请输入编号"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.id,callback:function(t){e.$set(e.filter,"id",t)},expression:"filter.id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"账号"}},[r("el-input",{attrs:{placeholder:"请输入账号"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.username,callback:function(t){e.$set(e.filter,"username",t)},expression:"filter.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{attrs:{placeholder:"请输入姓名"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.name,callback:function(t){e.$set(e.filter,"name",t)},expression:"filter.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"邮箱"}},[r("el-input",{attrs:{placeholder:"请输入邮箱"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.mail,callback:function(t){e.$set(e.filter,"mail",t)},expression:"filter.mail"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"联系电话"}},[r("el-input",{attrs:{placeholder:"请输入联系电话"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.cellphone,callback:function(t){e.$set(e.filter,"cellphone",t)},expression:"filter.cellphone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"创建时间"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.createTimeGE,callback:function(t){e.$set(e.filter,"createTimeGE",t)},expression:"filter.createTimeGE"}}),e._v("\n          至\n          "),r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.createTimeLE,callback:function(t){e.$set(e.filter,"createTimeLE",t)},expression:"filter.createTimeLE"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"修改时间"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.modifyTimeGE,callback:function(t){e.$set(e.filter,"modifyTimeGE",t)},expression:"filter.modifyTimeGE"}}),e._v("\n          至\n          "),r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.filter.modifyTimeLE,callback:function(t){e.$set(e.filter,"modifyTimeLE",t)},expression:"filter.modifyTimeLE"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),r("el-button",{attrs:{type:"info",icon:"el-icon-delete"},on:{click:e.clear}},[e._v("清空")])],1)],1)],1),e._v(" "),r("h4",{staticClass:"title"},[e._v("自定义参数列表")]),e._v(" "),r("hr"),e._v(" "),r("v-datagrid",{attrs:{columns:e.columns,"data-url":e.dataUrl,"count-url":e.countUrl,params:e.params,toolbar:e.toolbar}})],1):e._e(),e._v(" "),r("v-dialog",{ref:"testDialog",attrs:{"label-width":"6em",title:"测试登录",ok:e.doTest,"ok-text":"开始测试","cancel-text":"关闭"}},[r("el-form",{ref:"testForm",attrs:{slot:"body",model:e.test,"label-width":"6em"},slot:"body"},[r("el-form-item",{attrs:{label:"账号",prop:"username",rules:[{required:!0,message:"请输入账号",trigger:["blur","change"]}]}},[r("el-input",{model:{value:e.test.username,callback:function(t){e.$set(e.test,"username",t)},expression:"test.username"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"密码",prop:"password",rules:[{required:!0,message:"请输入密码",trigger:["blur","change"]}]}},[r("el-input",{attrs:{placeholder:"请输入新密码，长度随便设，只要你记得住"},model:{value:e.test.password,callback:function(t){e.$set(e.test,"password",t)},expression:"test.password"}})],1)],1)],1)],1):e._e()},staticRenderFns:[]};var o=r("C7Lr")(a,s,!1,function(e){r("ZPT6")},"data-v-1fa2ce0c",null);t.default=o.exports}});
//# sourceMappingURL=20.0a0dbd9e887fa4f0b8d7.js.map